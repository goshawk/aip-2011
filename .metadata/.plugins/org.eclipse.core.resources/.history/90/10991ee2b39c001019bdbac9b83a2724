package it.aip.controller;

import it.aip.models.*;
import it.aip.service.OrganicProductService;

import org.slim3.controller.Controller;
import org.slim3.controller.Navigation;
import org.slim3.datastore.Datastore;

import java.util.ArrayList;
import java.util.Collections;
import java.util.HashSet;
import java.util.List;

public class ProdottiController extends Controller {
    
    private OrganicProductService organicProductService = new OrganicProductService();

    @Override
    public Navigation run() throws Exception {
        
        List<OrganicProduct> organic_products = organicProductService.getAllOrganicProducts();  
        List<String> categorie = new ArrayList<String>();
        
        for(OrganicProduct x : organic_products){
            if(x.getProductCategory() != "")
                categorie.add(x.getProductCategory());
        }
        
        HashSet hashSet = new HashSet(categorie);
        ArrayList categories_no_duplicates = new ArrayList(hashSet);
        Collections.sort(categories_no_duplicates);



        
        requestScope("categorie", categorie);
        
        return forward("prodotti.jsp");
    }
}
